---
title: "如何编写和 Windows PowerShell ISE 中运行脚本"
ms.date: 2016-05-11
keywords: powershell cmdlet
description: 
ms.topic: article
author: jpjofre
manager: dongill
ms.prod: powershell
ms.assetid: 62f916d9-b3a1-484a-bdfb-41f57112c22b
ms.openlocfilehash: 5a18bc6126499dd44b5e7bf35ce29be957c4b0f4
ms.sourcegitcommit: 2fa86409b9183dfc80f4e9d4ff1015496e04fffd
translationtype: MT
---
# 如何编写和 Windows PowerShell ISE 中运行脚本
本主题介绍如何创建、 编辑、 运行和保存在脚本窗格中的脚本。

-   [如何创建和运行脚本](#bkmk_1)

-   [如何编写和编辑脚本窗格中的文本](#bkmk_2)

-   [如何保存脚本](#bkmk_3)

## <a name="bkmk_1"></a>如何创建和运行脚本
您可以打开和编辑 Windows PowerShellÂ® 脚本窗格中的文件。 特定的文件类型 Windows PowerShellÂ® 是兴趣的脚本文件 (.ps1)、 脚本数据文件 (.psd1) 和脚本模块文件 (.psm1)。 这些文件类型是彩色窗格脚本编辑器中的语法。 其他常见的文件类型，您可以在脚本窗格中打开的配置文件 (.ps1xml)、 XML 文件和文本文件。

> [!NOTE]
> Windows PowerShell 执行策略确定是否可以运行脚本并加载 Windows PowerShell 配置文件和配置文件。 默认执行策略，受限，阻止所有脚本运行，并都防止加载配置文件。 若要更改执行策略允许加载和使用的配置文件，请参阅[Set-executionpolicy [PSITPro5_Security]](https://technet.microsoft.com/en-us/library/5690a0e1-495b-4e63-8280-65ead7bf01ab)和[about_Signing [v4]](https://technet.microsoft.com/en-us/library/fcbdd3b9-0b9f-4734-b5c7-e0dcc304fa1d)。

### 若要创建新的脚本文件
在工具栏上，单击**新建**，或在**文件**菜单上，单击**新建**。 在当前 PowerShell 选项卡下的新文件选项卡中显示创建的文件。 请记住，PowerShell 将显示选项卡仅当有多个。 默认情况下创建类型脚本 (.ps1) 的文件，但它可以使用新名称和扩展名保存。 在同一 PowerShell 选项卡上，可以创建多个脚本文件。

### 若要打开现有脚本
在工具栏上，单击**打开...**，或在**文件**菜单上，单击**打开**。 在**打开**对话框中，选择您要打开的文件。 在新选项卡中显示打开的文件。

### 若要关闭脚本选项卡
单击您想要关闭，该脚本脚本选项卡，然后执行下列操作之一︰

1.  单击脚本选项卡上的**关闭**图标 (X)。

2.  在**文件**菜单上，单击**关闭**。

如果自上次保存以来，该文件已被更改，您会提示您保存或放弃它。

### 若要显示的文件路径
在文件选项卡，指向文件名。 在工具提示中显示的脚本文件的完全限定的路径。

### 若要运行脚本
工具栏上，单击**运行脚本**或**文件**菜单上单击**运行**。

### 若要运行脚本的一部分

1.  在脚本窗格中，选择脚本部分。

2.  在**文件**菜单中，单击**运行所选内容**，或的工具栏上，单击**运行选定内容**。

### 若要停止正在运行的脚本
工具栏上，单击**停止操作**，请按 CTRL + 分页符，或单击**文件**菜单上的**停止操作**。 按**CTRL + C**也适用，除非当前选定的一些文本，这种情况下**CTRL + C**将映射到所选文字的副本函数。

## <a name="bkmk_2"></a>如何编写和编辑脚本窗格中的文本
使用以下步骤在脚本窗格中编辑文本。 您可以复制、 剪切、 粘贴、 查找和替换文本。 您也可以撤消和恢复您刚才执行的最后一个操作。 执行这些操作的键盘快捷方式是用于所有 Windows 应用程序的相同。

### 在脚本窗格中输入文本

1.  将光标移动到脚本窗格中，通过在脚本窗格中，单击任意位置，或通过单击在**视图**菜单中的**转到脚本窗格**。

2.  创建一个脚本。 语法突出显示和选项卡上完成使其更丰富的体验 Windows PowerShell ISE 中。

3.  有关使用选项卡上的自动完成功能来帮助中键入的详细信息，请参阅[如何使用脚本和控制台的窗格中的选项卡上完成](How-to-Use-Tab-Completion-in-the-Script-Pane-and-Console-Pane.md)。

### 若要查找脚本窗格中的文本

1.  若要查找文本的地方，请按**CTRL + F** ，或在**编辑**菜单上，单击**查找**在脚本。

2.  若要查找光标后的文本，请按**F3** ，或在**编辑**菜单上，单击**查找下一个，在脚本**。

3.  若要查找光标前的文本，请按**SHIFT + F3** ，或在**编辑**菜单上，单击**查找上一个，在脚本**。

### 若要查找和替换脚本窗格中的文本
按**CRTL + H** ，或者，在**编辑**菜单上，单击**替换**在脚本。 输入您要查找的文本和所需来替换它的文本，然后按**ENTER**。

### 若要转到特定脚本窗格中的文本行

1.  在脚本窗格中，按**CTRL + G** ，或者，单击**编辑**菜单上的**转到行**。

2.  输入行号。

### 在脚本窗格中复制的文本

1.  在脚本窗格中，选择要复制的文本。

2.  按**CTRL + C** ，或者的工具栏上，单击**复制**图标，或在**编辑**菜单上，单击**复制**。

### 在脚本窗格中剪切文本

1.  在脚本窗格中，选择要剪切的文本。

2.  按**CTRL + X**或的工具栏上，单击**剪切**图标，或在**编辑**菜单上，单击**剪切**。

### 若要将文本粘贴到脚本窗格
按**CTRL + V** ，或者的工具栏上，单击**粘贴**图标，或在**编辑**菜单上，单击**粘贴**。

### 若要撤消操作，在脚本窗格
按**CTRL + Z**或者，在工具栏上，单击**撤消**图标，或在**编辑**菜单上，单击**撤消**。

### 要恢复脚本窗格中的操作
按**CTRL + Y**或，请在工具栏上，单击**恢复**图标，或单击**编辑**菜单上的**恢复**。

## <a name="bkmk_3"></a>如何保存脚本
使用以下步骤以保存和命名脚本。 若要标记的文件，因为它已被更改尚未保存的脚本名称旁边将出现一个星号。 保存文件时，将消失星号。

### 若要保存脚本
按**CTRL + S**或者，在工具栏上，单击**保存**图标，或在**文件**菜单上，单击**保存**。

### 若要保存和命名脚本

1.  在**文件**菜单上，单击**另存为**。 **另存为**对话框中会显示。

2.  在**文件名**框中，输入文件的名称。

3.  在**保存类型**框中，选择文件类型。 例如，在**保存类型**框中，选择"PowerShell 脚本 (\* .ps1)"。

4.  单击**保存**。

### 若要保存在 ASCII 编码的脚本
默认情况下，Windows PowerShell ISE 保存新的脚本文件 (.ps1)、 脚本数据文件 (.psd1) 和脚本模块文件 (.psm1) 为 Unicode (BigEndianUnicode) 默认情况下。 保存脚本中另一种编码，如 ASCII (ANSI)，请使用[$psISE.CurrentFile](https://technet.microsoft.com/en-us/library/bc3300e4-9c17-4f00-a621-c8867126e3b3#CurrentFile)对象上的**保存**或**另存为**方法。

使用 ASCII 编码情况下，以下命令保存为 MyScript.ps1 的新脚本。

```
$psise.CurrentFile.SaveAs("MyScript.ps1", [System.Text.Encoding]::ASCII)
```

以下命令将替换文件具有相同的名称，但是 ASCII 编码的当前脚本文件。

```
$psise.CurrentFile.Save([System.Text.Encoding]::ASCII)
```

以下命令获取当前文件的编码。

```
$psise.CurrentFile.encoding
```

Windows PowerShell ISE 支持以下编码选项︰ ASCII、 BigEndianUnicode、 Unicode、 UTF32、 UTF7、 UTF8 和默认值。 默认选项的值随系统。

Windows PowerShell ISE 不会更改的编码的脚本的其他编辑器中，在创建的 Windows PowerShell ISE 中即使在使用保存或另存为命令。

## 另请参阅
[使用 Windows PowerShell ISE](Using-the-Windows-PowerShell-ISE.md)

